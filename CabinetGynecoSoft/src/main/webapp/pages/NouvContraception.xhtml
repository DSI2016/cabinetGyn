<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<title>Antécédents</title>
	<link rel="stylesheet" type="text/css" href="../css/styles.css"></link>
</h:head>
<h:body style="background-image: url(../imagesMenu/fond.png);" onload="">
	<p:graphicImage value="/imagesTitre/antecedents.png"  width="100%"></p:graphicImage>
	<br />
	<h:form id="f1">
		<p:panel>
			<h:panelGrid columns="2">
				<h:outputText value="Date Début : " />
				<h:inputText value="" />

				<h:outputText value="Moyen: " />

				<p:selectOneMenu value="#{nouvelleContraceptionBean.moyen}"
					style="width:180px" panelStyle="width:180px" effect="fade">

					<f:selectItems value="#{nouvelleContraceptionBean.moyens}" var="a"
						itemLabel="#{a.libMoyenContraception}"
						itemValue="#{a.libMoyenContraception}" />
				</p:selectOneMenu>


				<h:outputText value="Remarque: " />
				<h:inputTextarea value="#{nouvelleContraceptionBean.remarque}" />


				<p:commandButton value="Valider"  action="Antecedent"
					actionListener="#{nouvelleContraceptionBean.validerContraception()}">

				</p:commandButton>
				<p:commandButton value="Annuler"></p:commandButton>
			</h:panelGrid>


		</p:panel>
	</h:form>
		<p:notificationBar position="bottom" effect="slide"
		style="height:300px" widgetVar="bar">
		<table width="98%" border="0">
			<tr>
				<td valign="top" width="95%"><p:panel style="width: 98%;">
						<h:form id="form">
							<p:remoteCommand name="updateList" update="users" process="@this" />
							<p:poll interval="10" update=":form:container" />
							<p:fieldset id="container" legend="GynécoSoft Chat"
							>

								<h:panelGroup>
									<table border="0" width="99%">
										<tr>
											<td valign="top" width="20%"><p:dataList id="users"
													var="user" value="#{chatUsers.users}"
													styleClass="usersList"
													emptyMessage="Pas d'utilisateurs connectés">
													<f:facet name="header">
                        Utilisateurs
                    </f:facet>
													<p:commandButton title="Chat" icon="ui-icon-comment"
														oncomplete="PF('pChat').show()"
														update=":form:privateChatContainer">
														<f:setPropertyActionListener value="#{user}"
															target="#{chatView.privateUser}" />
													</p:commandButton>
                    #{user}
                </p:dataList></td>
											<td valign="top" width="50%"><p:dataList id="public"
													paginator="true" rows="5" paginatorAlwaysVisible="false"
													paginatorPosition="bottom" var="m"
													emptyMessage="Il n'y a pas encore d'historique"
													value="#{historiqueMessage.listeMessages}">
													<f:facet name="header">
                      Historique de discusion
                    </f:facet>
                    #{m}
                </p:dataList></td>
											<td valign="top" width="30%"><p:panel header="Message"
													style="width:100%">
													<h:panelGroup>
														<p:inputTextarea style="width:98%"
															value="#{chatView.globalMessage}"
															styleClass="messageInput"></p:inputTextarea>

														<p:spacer width="5" />
														<p:commandButton value="Send"
															actionListener="#{chatView.sendGlobal}"
															oncomplete="$('.messageInput').val('').focus()"
															update=":form:container" />

													</h:panelGroup>
												</p:panel></td>
										</tr>
									</table>

								</h:panelGroup>

							</p:fieldset>

							<p:dialog widgetVar="pChat" header="Private Chat" modal="true"
								showEffect="fade" hideEffect="fade">
								<h:panelGrid id="privateChatContainer" columns="2"
									columnClasses="vtop,vtop">
									<p:outputLabel for="pChatInput"
										value="To: #{chatView.privateUser}" />
									<p:inputTextarea id="pChatInput"
										value="#{chatView.privateMessage}" rows="5" cols="30" />

									<p:spacer />
									<p:commandButton value="Send"
										actionListener="#{chatView.sendPrivate}"
										oncomplete="PF('pChat').hide()" />
								</h:panelGrid>
							</p:dialog>
						</h:form>

						<p:socket onMessage="handleMessage" channel="/{room}"
							autoConnect="false" widgetVar='subscriber'>

						</p:socket>

						<script type="text/javascript">
    function handleMessage(message) {
        var chatContent = $(PrimeFaces.escapeClientId('form:public')),
        text = (message.user) ? message.user + ':' + message.text: message.text;
 
        chatContent.append(text + '<br />');
 
        //keep scroll
        chatContent.scrollTop(chatContent.height());
        PF('wgrowl').show([message]);
        if(message.updateList) {
            updateList();
        }
    }
</script>
					</p:panel></td>
				<td valign="top"><div align="right">
						<p:commandButton onclick="PF('bar').hide()" type="button"
							icon="ui-icon-closethick" />
					</div></td>
			</tr>
		</table>

	</p:notificationBar>
	<div class="footer" align="right">
	
		<h:panelGroup id="tb" layout="block">

			<p:commandLink onclick="PF('bar').show()">
				<h:graphicImage value="../images/Chaticon.png" />
			</p:commandLink>
		</h:panelGroup>
	</div>

	<style type="text/css">
.footer {
	background-color: transparent;
	width: 100%;
	height: 70px;
	position: fixed;
	bottom: 0;
	left: 0;
}
</style>
</h:body>
</html>